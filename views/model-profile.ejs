<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Model Profile & Legal Portal – LumenNyx Studios</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/css/style.css" />

  <style>
    /* Print helpers: print only the release/consent blocks when requested */
    @media print {
      .no-print { display: none !important; }
      .print-block { break-inside: avoid; }
      body { background: #fff !important; }
      a[href]:after { content: ""; }
    }
    .print-toolbar {
      display: flex; gap: 10px; flex-wrap: wrap; margin: 10px 0 0 0;
    }
    .muted {
      color: #9aa0b5;
      font-size: 0.9rem;
    }
    .mono {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 0.9rem;
      word-break: break-word;
    }
  </style>
</head>
<body>
  <!-- HEADER -->
  <header class="site-header no-print">
    <div class="site-header-inner">
      <a href="/" class="brand-link">
        <span class="brand-mark">
          <img src="/img/lumennyx-mark.png" alt="LumenNyx logo">
        </span>
        <span class="brand-text">LUMENNYX STUDIOS</span>
      </a>

      <nav class="main-nav">
        <a href="/model/profile" class="active">Model Portal</a>
        <a href="/model/scenes">My Scenes</a>
        <a href="/model/signature">Signature</a>
        <a href="/privacy">Privacy</a>
        <a href="/terms">Terms</a>
        <a href="/2257">2257</a>
        <form action="/logout" method="POST" style="display:inline;">
          <button class="btn secondary" style="padding:0.25rem 0.9rem;font-size:0.8rem;">Logout</button>
        </form>
      </nav>
    </div>
  </header>

  <main class="home" style="max-width: 1100px; margin: 1.5rem auto 2rem auto; padding: 0 1.25rem;">
    <!-- HERO / INTRO -->
    <section class="hero no-print">
      <div class="hero-logo-bg"></div>

      <h2>Model Profile & Legal Portal</h2>
      <p>
        This private portal lets you manage identity details, compliance documents,
        your general/master release, and consent / safety preferences for LumenNyx Studios
        (independent production studio based in Wallkill, NY 12589).
      </p>
      <p class="hero-note">
        This portal is for record-keeping and clarity only and is not individual legal advice.
        Consult your own attorney if you have legal questions about your rights or contracts.
      </p>

      <div class="hero-buttons">
        <a href="#identity" class="btn primary">Identity &amp; Contact</a>
        <a href="#docs" class="btn secondary">Documents</a>
        <a href="#photos" class="btn secondary">Photos</a>
        <a href="#release" class="btn secondary">Master Release</a>
        <a href="#safety" class="btn secondary">Safety &amp; Consent</a>
      </div>
    </section>

    <!-- ✅ NEW: AGENCY / INDEPENDENT PATH CLARIFICATION (ADD-ONLY) -->
    <section class="portal-section no-print">
      <h3>Working With Agencies &amp; Independent Talent</h3>
      <p class="portal-note" style="margin-bottom:0.6rem;">
        We work with both represented talent (via agencies/managers) and independent performers.
        Compliance standards are the same for all shoots. Process timing differs slightly depending on representation.
      </p>

      <div class="documents-list" style="margin-top:0.6rem;">
        <table>
          <thead>
            <tr>
              <th style="width:33%;">For Agencies / Booking Representatives</th>
              <th style="width:33%;">For Independent Talent</th>
              <th style="width:34%;">Timing &amp; Documentation</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>
                <ul style="margin:0; padding-left:1.1rem;">
                  <li>We coordinate bookings directly with agencies or managers.</li>
                  <li>Call sheets, scope, rates, and boundaries confirmed in advance.</li>
                  <li>Payment and paperwork handled per agency preference.</li>
                </ul>
              </td>
              <td>
                <ul style="margin:0; padding-left:1.1rem;">
                  <li>Initial conversation first (scope, rate, boundaries).</li>
                  <li>Mutual agreement confirmed in writing.</li>
                  <li>No paperwork required just to ask questions or inquire.</li>
                </ul>
              </td>
              <td>
                <ul style="margin:0; padding-left:1.1rem;">
                  <li>All age verification and consent documentation is completed <strong>after booking terms are agreed upon</strong>, and <strong>prior to any filming</strong>.</li>
                  <li>Compliance records are stored securely and are not publicly accessible.</li>
                </ul>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <p class="field-help" style="margin-top:0.75rem;">
        This portal supports professional workflows and intentionally controlled access. If you are represented,
        your booking representative may prefer to handle certain confirmations externally before portal completion.
      </p>
    </section>
    <!-- END NEW BLOCK -->

    <!-- FLASH MESSAGES -->
    <% if (message) { %>
      <div class="alert success no-print"><%= message %></div>
    <% } %>
    <% if (error) { %>
      <div class="alert error no-print"><%= error %></div>
    <% } %>

    <!-- PROFILE STATUS OVERVIEW -->
    <section class="portal-section no-print">
      <h3>Profile Status Overview</h3>
      <p class="portal-note">
        This summary helps you and the studio quickly see what is on file and what is still missing.
      </p>

      <div class="status-summary">
        <div class="status-pill <%= (profile && profile.legal_name && profile.date_of_birth) ? 'ok' : 'missing' %>">
          <span class="label">Identity:</span>
          <span><%= (profile && profile.legal_name && profile.date_of_birth) ? 'On file' : 'Missing' %></span>
        </div>

        <div class="status-pill <%= (documents && documents.length) ? 'ok' : 'missing' %>">
          <span class="label">ID / Docs:</span>
          <span><%= (documents && documents.length) ? 'Uploaded' : 'None uploaded' %></span>
        </div>

        <div class="status-pill <%= masterRelease ? 'ok' : 'pending' %>">
          <span class="label">Master Release:</span>
          <span><%= masterRelease ? 'Signed' : 'Not signed yet' %></span>
        </div>

        <div class="status-pill <%= policies ? 'ok' : 'pending' %>">
          <span class="label">Consent &amp; Safety:</span>
          <span><%= policies ? 'Saved' : 'Not completed' %></span>
        </div>
      </div>
    </section>

    <!-- 1. BASIC IDENTITY & CONTACT -->
    <section id="identity" class="portal-section">
      <h3>1. Legal Identity &amp; Contact Details</h3>
      <p class="portal-note">
        This information must match your government ID for age verification and record-keeping.
        It is stored securely and used for internal compliance, scheduling, and payments.
      </p>

      <!-- ✅ NEW: TIMING REASSURANCE (ADD-ONLY) -->
      <p class="field-help" style="margin-top:0.4rem;">
        If you are represented, booking terms are typically confirmed through your agency first.
        Any required verification and releases are completed securely <strong>after agreement</strong> and <strong>before filming</strong>.
      </p>

      <form action="/model/profile/basic" method="POST" class="portal-form">
        <label>
          Legal name (as on government ID) *
          <input
            type="text"
            name="legal_name"
            required
            value="<%= (profile && profile.legal_name) ? profile.legal_name : '' %>"
          />
        </label>

        <label>
          Stage name / aliases (comma separated)
          <input
            type="text"
            name="aliases"
            value="<%= (profile && profile.aliases) ? profile.aliases : '' %>"
          />
        </label>

        <label>
          Preferred name on set (optional)
          <input
            type="text"
            name="preferred_name"
            value="<%= (profile && profile.preferred_name) ? profile.preferred_name : '' %>"
          />
        </label>

        <label>
          Date of birth *
          <input
            type="date"
            name="date_of_birth"
            required
            value="<%= (profile && profile.date_of_birth) ? profile.date_of_birth : '' %>"
          />
        </label>

        <label>
          Country of residence
          <input
            type="text"
            name="country"
            value="<%= (profile && profile.country) ? profile.country : '' %>"
          />
        </label>

        <label>
          State / region
          <input
            type="text"
            name="state"
            value="<%= (profile && profile.state) ? profile.state : '' %>"
          />
        </label>

        <!-- Not stored in your backend right now -->
        <label class="no-print">
          City (optional) (Not stored yet)
          <input type="text" name="city" value="" disabled />
        </label>

        <label>
          Mobile phone number
          <input
            type="tel"
            name="phone"
            value="<%= (profile && profile.phone) ? profile.phone : '' %>"
          />
        </label>

        <label>
          Contact email for studio updates &amp; payments
          <input
            type="email"
            name="email"
            value="<%= (profile && profile.email) ? profile.email : '' %>"
          />
        </label>

        <label>
          Emergency contact name (optional)
          <input
            type="text"
            name="emergency_name"
            value="<%= (profile && profile.emergency_name) ? profile.emergency_name : '' %>"
          />
        </label>

        <label>
          Emergency contact phone (optional)
          <input
            type="tel"
            name="emergency_phone"
            value="<%= (profile && profile.emergency_phone) ? profile.emergency_phone : '' %>"
          />
        </label>

        <p class="field-help">
          Your email and phone number may be used for booking, scheduling, and payment communication only.
          They are not publicly shared by LumenNyx Studios.
        </p>

        <button type="submit" class="btn primary no-print">Save Identity Details</button>
      </form>
    </section>

    <!-- 2. COMPLIANCE DOCUMENTS -->
    <section id="docs" class="portal-section">
      <h3>2. Compliance Documents on File</h3>
      <p class="portal-note">
        Upload legible scans or photos of IDs and paperwork. Files are stored securely
        for lawful compliance and record-keeping.
      </p>

      <!-- ✅ NEW: COMPLIANCE TIMING SENTENCE (ADD-ONLY) -->
      <p class="field-help" style="margin-top:0.4rem;">
        All age verification and consent documentation is completed <strong>after booking terms are agreed upon</strong>,
        and <strong>prior to any filming</strong>, in line with agency and legal requirements.
      </p>

      <% if (documents && documents.length > 0) { %>
        <div class="documents-list">
          <table>
            <thead>
              <tr>
                <th>Type</th>
                <th>Filename</th>
                <th>Uploaded At</th>
              </tr>
            </thead>
            <tbody>
              <% documents.forEach(function(doc) { %>
                <tr>
                  <td><%= doc.doc_type %></td>
                  <td>
                    <a href="/uploads/docs/<%= doc.filename %>" target="_blank" rel="noopener">
                      <%= doc.filename %>
                    </a>
                  </td>
                  <td><%= doc.uploaded_at %></td>
                </tr>
              <% }); %>
            </tbody>
          </table>
        </div>

        <p class="field-help">
          A W-9 is marked as uploaded in your profile when a document with type
          <strong>w9</strong> is on file.
        </p>
      <% } else { %>
        <p>No compliance documents have been uploaded yet.</p>
      <% } %>

      <form
        action="/model/profile/upload-doc"
        method="POST"
        enctype="multipart/form-data"
        class="portal-form"
        style="margin-top:1rem;"
      >
        <label>
          Document type *
          <select name="doc_type" required>
            <option value="">Select a document type…</option>
            <option value="id_primary_front">Primary ID – front</option>
            <option value="id_primary_back">Primary ID – back</option>
            <option value="id_secondary">Secondary ID</option>
            <option value="selfie_with_id">Selfie holding ID</option>
            <option value="w9">Tax form (W-9)</option>
            <option value="sti_test">Recent test (optional)</option>
            <option value="other">Other supporting document</option>
          </select>
        </label>

        <label>
          Upload file (JPG / PNG / PDF, max 20 MB) *
          <input type="file" name="document" accept=".jpg,.jpeg,.png,.pdf" required />
        </label>

        <p class="field-help">
          By uploading, you confirm these documents are accurate and belong to you.
          LumenNyx Studios will store them securely and only use them for lawful compliance,
          age verification, and tax purposes.
        </p>

        <button type="submit" class="btn secondary no-print">Upload Document</button>
      </form>
    </section>

    <!-- 2b. HEADSHOTS & PORTFOLIO -->
    <section id="photos" class="portal-section">
      <h3>2b. Headshots &amp; Portfolio Photos</h3>
      <p class="portal-note">
        Upload a clear headshot and any portfolio shots you’d like the studio to use
        for internal casting, planning, and scene concepts.
        Public / marketing use requires separate written consent.
      </p>

      <% if (photos && photos.length > 0) { %>
        <div class="documents-list">
          <table>
            <thead>
              <tr>
                <th>Preview</th>
                <th>Caption</th>
                <th>Primary?</th>
                <th>Uploaded</th>
              </tr>
            </thead>
            <tbody>
              <% photos.forEach(function(photo) { %>
                <tr>
                  <td>
                    <a href="/uploads/photos/<%= photo.filename %>" target="_blank" rel="noopener">
                      <img
                        src="/uploads/photos/<%= photo.filename %>"
                        alt="Model photo"
                        style="width:60px;height:60px;object-fit:cover;border-radius:8px;"
                      />
                    </a>
                  </td>
                  <td><%= photo.caption || "-" %></td>
                  <td><%= photo.is_primary ? "Yes" : "No" %></td>
                  <td><%= photo.uploaded_at %></td>
                </tr>
              <% }); %>
            </tbody>
          </table>
        </div>
      <% } else { %>
        <p>No headshots or portfolio photos uploaded yet.</p>
      <% } %>

      <form
        action="/model/profile/upload-photo"
        method="POST"
        enctype="multipart/form-data"
        class="portal-form"
        style="margin-top:1rem;"
      >
        <label>
          Upload photo (JPG / PNG / WEBP, max 10 MB) *
          <input type="file" name="photo" accept=".jpg,.jpeg,.png,.webp" required />
        </label>

        <label>
          Caption (optional)
          <input type="text" name="caption" maxlength="120" />
        </label>

        <label class="checkbox-label">
          <input type="checkbox" name="is_primary" />
          Set this as my main headshot for internal studio use.
        </label>

        <p class="field-help">
          You confirm you have the rights to these photos and that LumenNyx Studios may
          store and view them for internal casting, compliance, and planning.
          Any external or public marketing use will require an additional agreement.
        </p>

        <button type="submit" class="btn secondary no-print">Upload Photo</button>
      </form>
    </section>

    <!-- 3. MASTER MODEL RELEASE -->
    <section id="release" class="portal-section print-block">
      <h3>3. General / Master Model Release</h3>

      <div class="print-toolbar no-print">
        <button class="btn secondary" type="button" onclick="window.print()">Print this page</button>
        <a class="btn secondary" href="#identity">Back to Identity</a>
        <a class="btn secondary" href="#safety">Go to Consent</a>
        <a class="btn primary" href="/model/release">Open full Master Release page</a>
      </div>

      <div class="release-box">
        <div class="release-text" style="line-height:1.45;">
          <h4 style="margin-top:0;">MASTER MODEL RELEASE & PERFORMANCE AGREEMENT (GENERAL)</h4>

          <p class="muted">
            Note: The language below is placeholder informational text. For a production-ready agreement,
            use attorney-supplied terms. This portal will store the signature, timestamp, IP address, and user-agent.
          </p>

          <p>
            This section is intended to present the studio’s general master release terms for review and signature.
            Studio and performer acknowledge that scene-specific terms may be agreed separately.
          </p>

          <p class="field-help" style="margin-top:0.75rem;">
            Electronic signature: By checking the box and typing your full legal name, you agree that this constitutes your electronic signature.
            The portal records the signature timestamp and may record technical metadata (e.g., IP address and browser user-agent) for audit purposes.
          </p>
        </div>

        <div class="release-status" style="margin-top:1rem;">
          <% if (masterRelease) { %>
            <p>
              <strong>On file:</strong>
              Signed by <em><%= masterRelease.signed_name %></em> on
              <%= masterRelease.signed_at %>.
            </p>

            <p style="margin-top:0.4rem;">
              <strong>IP address recorded:</strong>
              <span class="mono"><%= masterRelease.ip_address ? masterRelease.ip_address : '—' %></span>
              <br/>
              <strong>User-Agent recorded:</strong>
              <span class="mono"><%= masterRelease.user_agent ? masterRelease.user_agent : '—' %></span>
            </p>
          <% } else { %>
            <p><strong>Status:</strong> You have not yet signed the Master Model Release in this portal.</p>
          <% } %>
        </div>

        <form action="/model/release" method="POST" class="portal-form" style="margin-top:1rem;">
          <label class="checkbox-label">
            <input type="checkbox" name="agree_master_release" required />
            I have read and agree to the Master Model Release terms above.
          </label>

          <label>
            Type your full legal name as your digital signature *
            <input
              type="text"
              name="signed_name"
              required
              value=""
              placeholder="Full legal name"
            />
          </label>

          <p class="field-help">
            If you already signed and need a correction, you may re-sign here. The studio will keep prior signatures for audit history.
          </p>

          <button type="submit" class="btn primary no-print">
            <%= masterRelease ? 'Re-Sign Master Release' : 'Sign Master Release' %>
          </button>
        </form>
      </div>
    </section>

    <!-- 4. SAFETY, CONSENT & SCENE PREFERENCES -->
    <section id="safety" class="portal-section print-block">
      <h3>4. Safety, Consent &amp; Scene Preferences</h3>
      <p class="portal-note">
        Use this section to outline limits, comfort zones, and safety rules.
        This helps protect boundaries and ensures clear planning.
      </p>

      <div class="print-toolbar no-print">
        <button class="btn secondary" type="button" onclick="window.print()">Print this page</button>
      </div>

      <form action="/model/profile/policies" method="POST" class="portal-form">

        <!-- 4.1 Health & STI Info -->
        <fieldset>
          <legend>Health &amp; Testing (high-level info)</legend>

          <label class="checkbox-label">
            <input
              type="checkbox"
              name="sti_testing_routine"
              <%= (policies && policies.sti_testing_routine) ? 'checked' : '' %>
            />
            I maintain a regular testing routine appropriate for my level of activity.
          </label>

          <label class="checkbox-label">
            <input
              type="checkbox"
              name="sti_disclosure_truth"
              <%= (policies && policies.sti_disclosure_truth) ? 'checked' : '' %>
            />
            I agree to honestly disclose safety-relevant health information to the studio if it could affect safety.
          </label>

          <label>
            Notes the studio should know (injuries, allergies, medications, or other safety-relevant info)
            <textarea name="sti_notes"><%= (policies && policies.sti_notes) ? policies.sti_notes : '' %></textarea>
          </label>

          <p class="field-help">
            Do not share details you are not comfortable disclosing. Focus on what affects on-set safety.
            LumenNyx Studios does not provide medical advice.
          </p>
        </fieldset>

        <!-- 4.2 General Consent -->
        <fieldset>
          <legend>General Physical Consent</legend>

          <label class="checkbox-label">
            <input
              type="checkbox"
              name="consent_allows_kissing"
              <%= (policies && policies.consent_allows_kissing) ? 'checked' : '' %>
            />
            I am generally comfortable with kissing, subject to scene-by-scene agreement.
          </label>

          <label class="checkbox-label">
            <input
              type="checkbox"
              name="consent_allows_nudity"
              <%= (policies && policies.consent_allows_nudity) ? 'checked' : '' %>
            />
            I am comfortable appearing nude on camera.
          </label>

          <label class="checkbox-label">
            <input
              type="checkbox"
              name="consent_allows_rough"
              <%= (policies && policies.consent_allows_rough) ? 'checked' : '' %>
            />
            I may be open to controlled rough or intense scenes, only within clearly agreed limits.
          </label>

          <label class="checkbox-label">
            <input
              type="checkbox"
              name="consent_allows_choking"
              <%= (policies && policies.consent_allows_choking) ? 'checked' : '' %>
            />
            I may be open to breath-related fantasy content only if discussed in detail and performed safely.
          </label>

          <label>
            Hard limits – absolutely never okay on camera *
            <textarea name="consent_hard_limits" required><%= (policies && policies.consent_hard_limits) ? policies.consent_hard_limits : '' %></textarea>
          </label>

          <label>
            Soft limits / “ask first every time”
            <textarea name="consent_soft_limits"><%= (policies && policies.consent_soft_limits) ? policies.consent_soft_limits : '' %></textarea>
          </label>

          <p class="field-help">
            You may include preferences about boundaries, protective measures, language limits, and any topics you never want associated with you.
          </p>
        </fieldset>

        <!-- 4.3 On-Set Safety Rules -->
        <fieldset>
          <legend>On-set Safety &amp; Conduct Rules</legend>

          <label class="checkbox-label">
            <input
              type="checkbox"
              name="policy_no_substances"
              <%= (policies && policies.policy_no_substances) ? 'checked' : '' %>
            />
            I understand illegal drugs and performing while impaired are not allowed on set.
          </label>

          <label class="checkbox-label">
            <input
              type="checkbox"
              name="policy_safe_word"
              <%= (policies && policies.policy_safe_word) ? 'checked' : '' %>
            />
            I agree to use a clear safe word or stop signal if I need a break or want to stop a scene.
          </label>

          <label class="checkbox-label">
            <input
              type="checkbox"
              name="policy_breaks"
              <%= (policies && policies.policy_breaks) ? 'checked' : '' %>
            />
            I understand I can request reasonable breaks for water, restroom, makeup, or emotional reset.
          </label>

          <label class="checkbox-label">
            <input
              type="checkbox"
              name="policy_reporting"
              <%= (policies && policies.policy_reporting) ? 'checked' : '' %>
            />
            I understand I can report unsafe behavior, boundary violations, or harassment to the studio and my concerns will be taken seriously.
          </label>
        </fieldset>

        <!-- 4.4 Takedowns / Removal -->
        <fieldset>
          <legend>Content Removal Requests &amp; Expectations</legend>

          <label class="checkbox-label">
            <input
              type="checkbox"
              name="policy_understand_no_guaranteed_removal"
              <%= (policies && policies.policy_understand_no_guaranteed_removal) ? 'checked' : '' %>
            />
            I understand complete removal from the internet may not be possible once released.
          </label>

          <label class="checkbox-label">
            <input
              type="checkbox"
              name="policy_internal_requests"
              <%= (policies && policies.policy_internal_requests) ? 'checked' : '' %>
            />
            I understand I can request internal takedown/limited use; the studio will review in good faith.
          </label>

          <label>
            Notes or preferences about future removal / takedown requests
            <textarea name="policy_removal_notes"><%= (policies && policies.policy_removal_notes) ? policies.policy_removal_notes : '' %></textarea>
          </label>
        </fieldset>

        <!-- 4.5 Contractor Acknowledgement -->
        <fieldset>
          <legend>Independent Contractor Acknowledgement</legend>

          <label class="checkbox-label">
            <input
              type="checkbox"
              name="contractor_acknowledge"
              <%= (policies && policies.contractor_acknowledge) ? 'checked' : '' %>
            />
            I understand work is typically as an independent contractor, not an employee.
          </label>

          <label>
            Type your name to confirm you read and understood the above sections
            <input
              type="text"
              name="contractor_signature"
              value="<%= (policies && policies.contractor_signature) ? policies.contractor_signature : '' %>"
            />
          </label>

          <p class="field-help">
            This is not a full contractor agreement. It confirms you reviewed consent/safety expectations.
          </p>
        </fieldset>

        <button type="submit" class="btn primary no-print">Save Safety &amp; Consent Settings</button>
      </form>
    </section>
  </main>
</body>
</html>
