<!-- FILE: views/register.ejs -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Model Registration – LumenNyx Studios</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/css/style.css" />
</head>
<body class="auth-page">
  <header class="site-header">
    <div class="site-header-inner">
      <a href="/" class="brand-link">
        <span class="brand-mark">
          <img src="/img/lumennyx-mark.png" alt="LumenNyx logo">
        </span>
        <span class="brand-text">LUMENNYX STUDIOS</span>
      </a>

      <nav class="main-nav">
        <a href="/">Home</a>
        <a href="/privacy">Privacy</a>
        <a href="/terms">Terms</a>
        <a href="/2257">2257</a>
      </nav>
    </div>
  </header>

  <main class="page-wrapper">
    <section class="auth-card">
      <h2>Model Registration (Pre-Vetting)</h2>
      <p class="auth-subtext">
        Submit preliminary information so we can review fit and availability.
        This is not a confirmed booking and not an account approval.
      </p>

      <% if (typeof error !== 'undefined' && error) { %>
        <div class="alert error"><%= error %></div>
      <% } %>
      <% if (typeof message !== 'undefined' && message) { %>
        <div class="alert success"><%= message %></div>
      <% } %>

      <!-- IMPORTANT: multipart required for photo uploads -->
      <form method="POST" action="/register" class="auth-form" enctype="multipart/form-data">
        <label class="field">
          <span>Stage Name (Required)</span>
          <input name="stage_name" type="text" required value="<%= (form && form.stage_name) ? form.stage_name : '' %>" />
        </label>

        <label class="field">
          <span>Legal Name (Optional)</span>
          <input name="legal_name" type="text" value="<%= (form && form.legal_name) ? form.legal_name : '' %>" />
          <small class="field-help">You can provide legal name later during formal paperwork.</small>
        </label>

        <label class="field">
          <span>Gender (Required)</span>
          <select name="gender" required>
            <option value="">Select…</option>
            <option value="Male" <%= (form && form.gender === 'Male') ? 'selected' : '' %>>Male</option>
            <option value="Female" <%= (form && form.gender === 'Female') ? 'selected' : '' %>>Female</option>
            <option value="Other" <%= (form && form.gender === 'Other') ? 'selected' : '' %>>Other</option>
          </select>
        </label>

        <label class="field">
          <span>Email (Required)</span>
          <input name="email" type="email" required value="<%= (form && form.email) ? form.email : '' %>" />
        </label>

        <label class="field">
          <span>Phone (Optional)</span>
          <input name="phone" type="text" value="<%= (form && form.phone) ? form.phone : '' %>" />
        </label>

        <label class="field">
          <span>Location (City/State) (Optional)</span>
          <input name="location" type="text" value="<%= (form && form.location) ? form.location : '' %>" />
        </label>

        <label class="field">
          <span>Socials / Handle (Optional)</span>
          <input name="socials" type="text" value="<%= (form && form.socials) ? form.socials : '' %>" />
        </label>

        <label class="field">
          <span>Portfolio Link (Optional)</span>
          <input name="portfolio" type="url" value="<%= (form && form.portfolio) ? form.portfolio : '' %>" />
        </label>

        <!-- Uploads: names MUST match multer fields in routes/auth.js -->
        <label class="field">
          <span>Headshot (Optional)</span>
          <input id="headshotInput" name="headshot" type="file" accept="image/png,image/jpeg,image/webp" />
          <small class="field-help">Recommended: clear face photo. JPG/PNG/WebP. Max 8MB.</small>
          <small class="field-help" id="headshotSelected" style="display:none;"></small>
        </label>

        <label class="field">
          <span>Portfolio Photos (Optional)</span>
          <!-- IMPORTANT: backend expects "photos" (not "portfolio_photos") -->
          <input id="photosInput" name="photos" type="file" accept="image/png,image/jpeg,image/webp" multiple />
          <small class="field-help">Up to 5 images. JPG/PNG/WebP. Max 8MB each.</small>
          <small class="field-help" id="photosSelected" style="display:none;"></small>
        </label>

        <label class="field">
          <span>Notes (Optional)</span>
          <textarea name="notes" rows="4"><%= (form && form.notes) ? form.notes : '' %></textarea>
        </label>

        <label class="field" style="margin-top: 0.6rem;">
          <span style="display:block; margin-bottom: 0.35rem;">Age Confirmation (Required)</span>
          <label style="display:flex; gap:0.6rem; align-items:center;">
            <input type="checkbox" name="age_confirm" value="yes" <%= (form && form.age_confirm === 'yes') ? 'checked' : '' %> />
            <span>I confirm I am 18+ and legally permitted to participate in adult content production.</span>
          </label>
        </label>

        <div style="display:flex; gap: 10px; justify-content:flex-end; margin-top: 12px;">
          <a class="btn secondary" href="/login">Login</a>
          <button class="btn primary" type="submit">Submit Application</button>
        </div>

        <p class="field-help" style="margin-top: 10px;">
          Submitting this form does not guarantee acceptance. If approved, you’ll receive instructions for completing compliance paperwork inside the portal.
        </p>
      </form>
    </section>
  </main>

  <script>
    (function () {
      const headshotInput = document.getElementById('headshotInput');
      const headshotSelected = document.getElementById('headshotSelected');

      const photosInput = document.getElementById('photosInput');
      const photosSelected = document.getElementById('photosSelected');

      function showSelected(el, files, single) {
        if (!el) return;
        if (!files || files.length === 0) {
          el.style.display = 'none';
          el.textContent = '';
          return;
        }
        el.style.display = 'block';
        if (single) {
          el.textContent = 'Selected: ' + files[0].name;
        } else {
          const names = Array.from(files).map(f => f.name);
          el.textContent = 'Selected (' + files.length + '): ' + names.join(', ');
        }
      }

      if (headshotInput) {
        headshotInput.addEventListener('change', function () {
          showSelected(headshotSelected, headshotInput.files, true);
        });
      }

      if (photosInput) {
        photosInput.addEventListener('change', function () {
          showSelected(photosSelected, photosInput.files, false);
        });
      }
    })();
  </script>
</body>
</html>
