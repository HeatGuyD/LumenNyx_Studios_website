<!-- FILE: views/studio-panel.ejs -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>LumenNyx Studios – Studio Panel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="/css/style.css">
</head>

<body class="home">

  <header class="site-header">
    <div class="site-header-inner">
      <a href="/studio-panel" class="brand-link">
        <span class="brand-mark">
          <img src="/img/lumennyx-mark.png" alt="LumenNyx Studios logo">
        </span>
        <span class="brand-text">LUMENNYX STUDIOS</span>
      </a>

      <nav class="main-nav">
        <a href="/studio-panel" class="active">Studio Panel</a>
        <a href="/studio-panel/applications">Applications</a>
        <a href="/studio-panel/models">Models</a>
        <a href="/studio-panel/docs">Docs Map</a>
        <a href="/studio-panel/scenes">Scenes</a>

        <!-- Added: Legal -->
        <a href="/studio-panel/legal-templates">Legal Templates</a>
        <a href="/studio-panel/legal-executed">Signed Legal</a>

        <a href="/2257">2257</a>

        <form action="/logout" method="POST" style="display:inline;">
          <button type="submit" class="btn secondary" style="padding:0.3rem 0.9rem;font-size:0.75rem;">
            Logout
          </button>
        </form>
      </nav>
    </div>
  </header>

  <main class="page-wrapper">

    <section class="portal-section">
      <h2>Studio Panel Dashboard</h2>
      <p class="portal-note">
        Internal studio dashboard for managing model applications, compliance paperwork,
        and scene records. This area is for <strong>admin / staff</strong> use only.
      </p>

      <% if (typeof message !== 'undefined' && message) { %>
        <div class="alert success"><%= message %></div>
      <% } %>
      <% if (typeof error !== 'undefined' && error) { %>
        <div class="alert error"><%= error %></div>
      <% } %>

      <%
        const s = (typeof stats !== 'undefined' && stats) ? stats : {};
        const totalModels = (typeof s.totalModels !== 'undefined') ? s.totalModels : 0;
        const pendingModels = (typeof s.pendingModels !== 'undefined') ? s.pendingModels : 0;
        const approvedModels = (typeof s.approvedModels !== 'undefined') ? s.approvedModels : 0;
        const pendingApplications = (typeof s.pendingApplications !== 'undefined') ? s.pendingApplications : 0;

        const emails = (typeof CONTACT_EMAILS !== 'undefined' && CONTACT_EMAILS) ? CONTACT_EMAILS : null;
        const mailToStudio = (typeof MAIL_TO_STUDIO !== 'undefined' && MAIL_TO_STUDIO) ? MAIL_TO_STUDIO : null;

        const roleLabel = (typeof role !== 'undefined' && role) ? role : 'staff';
      %>

      <div class="status-summary">
        <div class="status-pill ok">
          <span class="label">Total Models</span>
          <span><%= totalModels %></span>
        </div>
        <div class="status-pill pending">
          <span class="label">Pending Models</span>
          <span><%= pendingModels %></span>
        </div>
        <div class="status-pill ok">
          <span class="label">Approved Models</span>
          <span><%= approvedModels %></span>
        </div>
        <div class="status-pill pending">
          <span class="label">Pending Applications</span>
          <span><%= pendingApplications %></span>
        </div>
      </div>

      <p class="field-help" style="margin-top:1rem;">
        You are logged in with <strong><%= roleLabel %></strong> privileges.
        This panel contains confidential legal/compliance data. Use and share access accordingly.
      </p>

      <% if (emails || mailToStudio) { %>
        <div class="panel-inner" style="margin-top: 14px;">
          <h3 style="margin-top:0;">System Routing</h3>
          <p class="field-help" style="margin-top:6px;">
            Informational for staff — where compliance PDFs and notices route when email features are used.
          </p>

          <table class="kv-table">
            <tr>
              <th>Studio Archive (MAIL_TO_STUDIO)</th>
              <td><%= mailToStudio || '—' %></td>
            </tr>
            <tr>
              <th>Releases</th>
              <td><%= (emails && emails.release) ? emails.release : '—' %></td>
            </tr>
            <tr>
              <th>2257 / Records</th>
              <td><%= (emails && (emails['2257'] || emails.compliance2257)) ? (emails['2257'] || emails.compliance2257) : '—' %></td>
            </tr>
            <tr>
              <th>Legal</th>
              <td><%= (emails && emails.legal) ? emails.legal : '—' %></td>
            </tr>
            <tr>
              <th>Support</th>
              <td><%= (emails && emails.support) ? emails.support : '—' %></td>
            </tr>
          </table>
        </div>
      <% } %>

      <div class="policies-grid" style="margin-top:1.2rem;">
        <div class="policies-card">
          <h4>Model Applications</h4>
          <p>Review new sign-ups (pre-vetting), view submitted photos, and set application status.</p>
          <a href="/studio-panel/applications?status=pending" class="btn secondary" style="margin-top:0.5rem;">
            Review Applications (<%= pendingApplications %>)
          </a>
        </div>

        <div class="policies-card">
          <h4>Model Accounts</h4>
          <p>Manage approved portal accounts, verify docs, releases, consent, and W-9 status.</p>
          <a href="/studio-panel/models" class="btn secondary" style="margin-top:0.5rem;">Manage Models</a>
        </div>

        <div class="policies-card">
          <h4>Docs Map</h4>
          <p>View your internal map of required documents, storage paths, and what’s missing per model.</p>
          <a href="/studio-panel/docs" class="btn secondary" style="margin-top:0.5rem;">Open Docs Map</a>
        </div>

        <div class="policies-card">
          <h4>Scenes & Tagging</h4>
          <p>Create scene records, tag performers, and keep internal notes for record-keeping.</p>
          <a href="/studio-panel/scenes" class="btn secondary" style="margin-top:0.5rem;">View Scenes</a>
        </div>

        <div class="policies-card">
          <h4>Compliance & 2257</h4>
          <p>Use model and scene records to generate printable packets for your accountant/lawyer.</p>
          <a href="/2257" class="btn secondary" style="margin-top:0.5rem;">2257 / Legal Info</a>
        </div>

        <div class="policies-card">
          <h4>Legal Templates</h4>
          <p>Create/manage legal documents models must review and sign (template library).</p>
          <a href="/studio-panel/legal-templates" class="btn secondary" style="margin-top:0.5rem;">Open Legal Templates</a>
        </div>

        <div class="policies-card">
          <h4>Signed Legal Docs</h4>
          <p>View executed legal PDFs generated by models (audit trail).</p>
          <a href="/studio-panel/legal-executed" class="btn secondary" style="margin-top:0.5rem;">View Signed Legal Docs</a>
        </div>
      </div>

      <div class="panel-inner" style="margin-top: 16px;">
        <h3 style="margin-top:0;">Quick Actions</h3>
        <div style="display:flex; gap:10px; flex-wrap:wrap;">
          <a class="btn primary" href="/studio-panel/applications?status=pending">
            Review Applications (<%= pendingApplications %>)
          </a>
          <a class="btn primary" href="/studio-panel/models?status=pending">Review Pending Models</a>
          <a class="btn secondary" href="/studio-panel/models">All Models</a>
          <a class="btn secondary" href="/studio-panel/scenes">Scenes</a>
          <a class="btn secondary" href="/studio-panel/docs">Docs Map</a>
          <a class="btn secondary" href="/studio-panel/legal-templates">Legal Templates</a>
          <a class="btn secondary" href="/studio-panel/legal-executed">Signed Legal Docs</a>
        </div>
        <p class="field-help" style="margin-top:10px;">
          Tip: Review applications first, then create/approve portal accounts only after you’ve verified compliance requirements.
        </p>
      </div>

    </section>

  </main>
</body>
</html>
