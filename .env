# =========================
# CORE APP SETTINGS
# =========================
ADMIN_PASSWORD=Hapapanesia87@

NODE_ENV=development
# "development" locally. Use "production" when hosted.

PORT=3000
# The port your Express app listens on.

BASE_URL=http://localhost:3000
# Used to build absolute links in emails (ex: "View signed PDF").
# When hosted, change to: https://yourdomain.com

SESSION_SECRET=change_this_to_a_long_random_string
# Required for secure sessions. Use 32+ random characters.

TRUST_PROXY=false
# Set true ONLY if you host behind a reverse proxy (Render, Railway, Nginx, Cloudflare, etc).
# Needed so req.ip / secure cookies behave correctly behind a proxy.

COOKIE_SECURE=false
# true in production HTTPS. false locally.
# If true while on http://localhost, logins/sessions may break.
// ----------------------
// NODEMAILER (SMTP) - TEST + HELPERS
// ----------------------
const nodemailer = require('nodemailer');

function makeMailer() {
  const host = process.env.SMTP_HOST;
  const port = Number(process.env.SMTP_PORT || 587);
  const secure = String(process.env.SMTP_SECURE || 'false') === 'true';
  const user = process.env.SMTP_USER;
  const pass = process.env.SMTP_PASS;

  if (!host || !user || !pass) {
    throw new Error('SMTP is not configured. Set SMTP_HOST, SMTP_USER, SMTP_PASS in .env');
  }

  return nodemailer.createTransport({
    host,
    port,
    secure,
    auth: { user, pass },
  });
}

// Quick SMTP sanity test
app.get('/__email-test', async (req, res) => {
  try {
    const transporter = makeMailer();
    await transporter.verify();

    const to = process.env.MAIL_TO_STUDIO || process.env.SMTP_USER;

    await transporter.sendMail({
      from: process.env.MAIL_FROM || process.env.SMTP_USER,
      to,
      replyTo: process.env.MAIL_REPLY_TO || undefined,
      subject: 'LumenNyx SMTP test',
      text: 'SMTP is working.',
    });

    return res.send('EMAIL SENT');
  } catch (e) {
    console.error('EMAIL TEST FAIL:', e);
    return res.status(500).send(String(e?.message || e));
  }
});

# =========================
# CONTACT EMAILS (used in your EJS pages via CONTACT_EMAILS)
# =========================

CONTACT_EMAIL_SUPPORT=support@lumennyxstudios.com
CONTACT_EMAIL_MODELS=models@lumennyxstudios.com
CONTACT_EMAIL_LEGAL=legal@lumennyxstudios.com
CONTACT_EMAIL_2257=2257@lumennyxstudios.com
CONTACT_EMAIL_RELEASE=release@lumennyxstudios.com
CONTACT_EMAIL_CONTACT=contact@lumennyxstudios.com
# These should match what your EJS templates expect as CONTACT_EMAILS.*.
# In app.js youâ€™d map these env vars into an object like:
# CONTACT_EMAILS = { support, models, legal, '2257', release, contact }

# =========================
# SMTP / NODEMAILER SETTINGS (for emailing PDFs + addenda)
# =========================

SMTP_HOST=smtp.gmail.com
# Example: smtp.gmail.com (Gmail), smtp.office365.com (Microsoft), or your domain mail SMTP.

SMTP_PORT=465
# Common: 587 (STARTTLS) or 465 (SSL).

SMTP_SECURE=true
# true if using port 465, false if using 587.

SMTP_USER=dillon.young240@gmail.com
# Usually the full email address.

SMTP_PASS=bggd pvqk ahgf naoz
# If using Gmail, you typically need an App Password (not your normal password).

MAIL_FROM="LumenNyx Studios <dillon.young240@gmail.com>"
# The "From" name/email recipients will see.

MAIL_REPLY_TO=models@lumennyxstudios.com
# Where replies should go (optional but recommended).

MAIL_TO_STUDIO=admin@lumennyxstudios.com
# Where the studio receives copies/archives (optional).
# Useful for: "Model signed release" notifications.

# =========================
# PDF / EXPORT BEHAVIOR
# =========================

PDF_RETENTION_DAYS=3650
# How long to keep generated PDFs (example: 3650 = ~10 years).
# If you implement cleanup later, this drives it.

PDF_STORAGE_DIR=./private/pdfs
# Recommended: store generated PDFs outside /public.
# You can still provide download links via an authenticated route.

# =========================
# FILE UPLOAD SETTINGS (optional but useful)
# =========================

UPLOADS_DOCS_DIR=./uploads/docs
UPLOADS_PHOTOS_DIR=./uploads/photos
# Keep these aligned with how your multer storage is configured.
